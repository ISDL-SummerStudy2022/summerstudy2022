version: '3.9'
services:
  api:
    build:
      context: ./server
      dockerfile: dockerfile
    volumes:
      - ./server:/srv:cached
    ports:
      - '8080:8080'
    tty: true
  db:
    build:
      context: ./db
      dockerfile: dockerfile
    container_name: POSTGRESQL
    ports:
      - 5432:5432
    volumes:
      - ./db/postgres:/var/lib/postgresql/data:z
      - ./db/script:/docker-entrypoint-initdb.d 
    environment:
      - POSTGRES_USER=testroot
      - POSTGRES_PASSWORD=Password!
      - POSTGRES_INITDB_ARGS=--encoding=UTF-8
  pgadmin:
    image: dpage/pgadmin4:5.6
    container_name: pgadmin4
    ports:
      - 80:80
    volumes:
      - ./pgadmin:/var/lib/pgadmin/storage
    environment:
      PGADMIN_DEFAULT_EMAIL: root@root
      PGADMIN_DEFAULT_PASSWORD: root
    hostname: pgadmin4

volumes:
  postgres:
  pgadmin:

  